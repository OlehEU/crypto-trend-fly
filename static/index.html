<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Crypto Trend</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body>

<div class="container">
    <h1>Crypto Trend Analyzer</h1>

    <div class="controls">
        <select id="symbol">
            <option value="BTCUSDT">BTC/USDT</option>
            <option value="ETHUSDT">ETH/USDT</option>
        </select>

        <select id="interval">
            <option value="1m">1m</option>
            <option value="5m">5m</option>
            <option value="1h">1h</option>
            <option value="4h">4h</option>
        </select>

        <button onclick="loadData()">Обновить</button>
    </div>

    <div id="chart"></div>

    <div id="forecast"></div>
</div>

<script>
let chart;
let candleSeries;

async function loadData() {
    const symbol = document.getElementById("symbol").value;
    const interval = document.getElementById("interval").value;

    const res = await fetch(`/api/klines?symbol=${symbol}&interval=${interval}&limit=200`);
    const data = await res.json();

    candleSeries.setData(data);
}

function init() {
    chart = LightweightCharts.createChart(document.getElementById("chart"), {
        width: 900,
        height: 450,
        layout: { background: { color: "#111" }, textColor: "#DDD" },
        grid: { vertLines: { color: "#333" }, horzLines: { color: "#333" } }
    });

    candleSeries = chart.addCandlestickSeries();

    loadData();
}
init();

</script>
</body>
</html>
